FROM golang:latest
WORKDIR /app
COPY . /app
COPY go.mod go.sum /modules/

RUN go mod download
RUN go env -w CGO_ENABLED=0
RUN go env -w GOOS=linux
RUN go env -w GOARCH=amd64

ENV PROJECT_PATH /app
ENV DEFAULT_CONFIG_PATH "./config/test.container.toml"

CMD ["go", "test", "-v", "./tests/..."]